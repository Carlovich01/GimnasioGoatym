<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class DPlanes | Goatym </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class DPlanes | Goatym ">
      
      <meta name="description" content="Clase de acceso a datos para la gesti&#243;n de planes de membres&#237;a. Hereda de  y utiliza la entidad . Proporciona m&#233;todos CRUD y de b&#250;squeda para la tabla planes_membresia.">
      <link rel="icon" href="../images/logo.ico">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="../toc.html">
      
      <meta name="docfx:rel" content="../">
      
      
      <meta name="docfx:docurl" content="https://github.com/Carlovich01/gimnasio3/new/main/apiSpec/new?filename=Gimnasio_Datos_DPlanes.md&amp;value=---%0Auid%3A%20Gimnasio.Datos.DPlanes%0Asummary%3A%20&#39;*You%20can%20override%20summary%20for%20the%20API%20here%20using%20*MARKDOWN*%20syntax&#39;%0A---%0A%0A*Please%20type%20below%20more%20information%20about%20this%20API%3A*%0A%0A">
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../images/logo.svg" alt="Goatym">
            Goatym
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="Gimnasio.Datos.DPlanes">



  <h1 id="Gimnasio_Datos_DPlanes" data-uid="Gimnasio.Datos.DPlanes" class="text-break">
Class DPlanes  <a class="header-action link-secondary" title="View source" href="https://github.com/Carlovich01/gimnasio3/blob/main/Gimnasio.Datos/DPlanes.vb/#L13"><i class="bi bi-code-slash"></i></a>
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="Gimnasio.html">Gimnasio</a>.<a class="xref" href="Gimnasio.Datos.html">Datos</a></dd></dl>
  </div>

  <div class="markdown summary"><p>Clase de acceso a datos para la gestión de planes de membresía.
Hereda de <a class="xref" href="Gimnasio.Datos.ConexionBase.html">ConexionBase</a> y utiliza la entidad <a class="xref" href="Gimnasio.Entidades.Planes.html">Planes</a>.
Proporciona métodos CRUD y de búsqueda para la tabla <code>planes_membresia</code>.</p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class DPlanes : ConexionBase</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><a class="xref" href="Gimnasio.Datos.ConexionBase.html">ConexionBase</a></div>
      <div><span class="xref">DPlanes</span></div>
    </dd>
  </dl>





  <h2 id="Gimnasio_Datos_DPlanes_remarks">Remarks</h2>
  <div class="markdown level0 remarks"><p>Los diccionarios se utilizan para asociar los parametros de la consulta con los parametros del metodo</p>
</div>


  <h2 class="section" id="methods">Methods
</h2>


  <a id="Gimnasio_Datos_DPlanes_Actualizar_" data-uid="Gimnasio.Datos.DPlanes.Actualizar*"></a>

  <h3 id="Gimnasio_Datos_DPlanes_Actualizar_Gimnasio_Entidades_Planes_" data-uid="Gimnasio.Datos.DPlanes.Actualizar(Gimnasio.Entidades.Planes)">
  Actualizar(Planes)
  <a class="header-action link-secondary" title="View source" href="https://github.com/Carlovich01/gimnasio3/blob/main/Gimnasio.Datos/DPlanes.vb/#L63"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Recibe una instancia de Planes y ejecuta una sentencia SQL (UPDATE) que actualiza los campos de un registro de plan existente que
corresponde al id de la instancia.
Los valores nulos se almacenan como NULL en la base de datos.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void Actualizar(Planes Obj)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>Obj</code> <a class="xref" href="Gimnasio.Entidades.Planes.html">Planes</a></dt>
    <dd><p>Instancia de <a class="xref" href="Gimnasio.Entidades.Planes.html">Planes</a> con los datos actualizados.</p>
</dd>
  </dl>












  <a id="Gimnasio_Datos_DPlanes_Eliminar_" data-uid="Gimnasio.Datos.DPlanes.Eliminar*"></a>

  <h3 id="Gimnasio_Datos_DPlanes_Eliminar_System_UInt32_" data-uid="Gimnasio.Datos.DPlanes.Eliminar(System.UInt32)">
  Eliminar(uint)
  <a class="header-action link-secondary" title="View source" href="https://github.com/Carlovich01/gimnasio3/blob/main/Gimnasio.Datos/DPlanes.vb/#L86"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Recibe el id del plan a eliminar y ejecuta una sentencia SQL (DELETE) que elimina el registro de plan correspondiente.
Si el plan tiene membresías asociadas y existe una restricción de clave foránea, captura la excepción y lanza un mensaje específico.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void Eliminar(uint id)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>id</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.uint32">uint</a></dt>
    <dd><p>Identificador único del plan a eliminar.</p>
</dd>
  </dl>









  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.exception">Exception</a></dt>
    <dd><p>Se lanza si el plan tiene membresías asociadas o por errores de la base de datos.</p>
</dd>
  </dl>



  <a id="Gimnasio_Datos_DPlanes_Insertar_" data-uid="Gimnasio.Datos.DPlanes.Insertar*"></a>

  <h3 id="Gimnasio_Datos_DPlanes_Insertar_Gimnasio_Entidades_Planes_" data-uid="Gimnasio.Datos.DPlanes.Insertar(Gimnasio.Entidades.Planes)">
  Insertar(Planes)
  <a class="header-action link-secondary" title="View source" href="https://github.com/Carlovich01/gimnasio3/blob/main/Gimnasio.Datos/DPlanes.vb/#L37"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Utiliza los datos proporcionados en la instancia de Planes recibida para ejecutar una sentencia SQL(INSERT), la cual inserta el nuevo plan.
Los valores nulos se almacenan como NULL en la base de datos.
Se lanza una excepción si el nombre del plan ya existe.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void Insertar(Planes Obj)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>Obj</code> <a class="xref" href="Gimnasio.Entidades.Planes.html">Planes</a></dt>
    <dd><p>Instancia de <a class="xref" href="Gimnasio.Entidades.Planes.html">Planes</a> a insertar.</p>
</dd>
  </dl>









  <h4 class="section">Exceptions</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.exception">Exception</a></dt>
    <dd><p>Se lanza si el nombre del plan ya existe o por errores de la base de datos.</p>
</dd>
  </dl>



  <a id="Gimnasio_Datos_DPlanes_Listar_" data-uid="Gimnasio.Datos.DPlanes.Listar*"></a>

  <h3 id="Gimnasio_Datos_DPlanes_Listar" data-uid="Gimnasio.Datos.DPlanes.Listar">
  Listar()
  <a class="header-action link-secondary" title="View source" href="https://github.com/Carlovich01/gimnasio3/blob/main/Gimnasio.Datos/DPlanes.vb/#L20"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Ejecuta una consulta SQL (SELECT) que obtiene todos los planes de la base de datos ordenados por la última modificación.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public DataTable Listar()</code></pre>
  </div>


  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.data.datatable">DataTable</a></dt>
    <dd><p>DataTable con los datos de los planes.</p>
</dd>
  </dl>











  <a id="Gimnasio_Datos_DPlanes_ListarPorDuracion_" data-uid="Gimnasio.Datos.DPlanes.ListarPorDuracion*"></a>

  <h3 id="Gimnasio_Datos_DPlanes_ListarPorDuracion_System_UInt32_" data-uid="Gimnasio.Datos.DPlanes.ListarPorDuracion(System.UInt32)">
  ListarPorDuracion(uint)
  <a class="header-action link-secondary" title="View source" href="https://github.com/Carlovich01/gimnasio3/blob/main/Gimnasio.Datos/DPlanes.vb/#L129"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Recibe la duración en días del plan a buscar y ejecuta una sentencia SQL (SELECT) que busca coincidencias
en la base de datos. Utiliza la cláusula WHERE para filtrar por duración exacta.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public DataTable ListarPorDuracion(uint duracion)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>duracion</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.uint32">uint</a></dt>
    <dd><p>Duración en días del plan.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.data.datatable">DataTable</a></dt>
    <dd><p>DataTable con los resultados de la búsqueda.</p>
</dd>
  </dl>











  <a id="Gimnasio_Datos_DPlanes_ListarPorNombre_" data-uid="Gimnasio.Datos.DPlanes.ListarPorNombre*"></a>

  <h3 id="Gimnasio_Datos_DPlanes_ListarPorNombre_System_String_" data-uid="Gimnasio.Datos.DPlanes.ListarPorNombre(System.String)">
  ListarPorNombre(string)
  <a class="header-action link-secondary" title="View source" href="https://github.com/Carlovich01/gimnasio3/blob/main/Gimnasio.Datos/DPlanes.vb/#L110"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Recibe el nombre o parte del nombre del plan a buscar y ejecuta una sentencia SQL (SELECT) que busca coincidencias
en la base de datos. Utiliza la cláusula LIKE para permitir coincidencias parciales.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public DataTable ListarPorNombre(string nombre)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>nombre</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.string">string</a></dt>
    <dd><p>Nombre o parte del nombre del plan a buscar.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.data.datatable">DataTable</a></dt>
    <dd><p>DataTable con los resultados de la búsqueda.</p>
</dd>
  </dl>











  <a id="Gimnasio_Datos_DPlanes_ListarPorPrecio_" data-uid="Gimnasio.Datos.DPlanes.ListarPorPrecio*"></a>

  <h3 id="Gimnasio_Datos_DPlanes_ListarPorPrecio_System_Decimal_" data-uid="Gimnasio.Datos.DPlanes.ListarPorPrecio(System.Decimal)">
  ListarPorPrecio(decimal)
  <a class="header-action link-secondary" title="View source" href="https://github.com/Carlovich01/gimnasio3/blob/main/Gimnasio.Datos/DPlanes.vb/#L148"><i class="bi bi-code-slash"></i></a>
  </h3>

  <div class="markdown level1 summary"><p>Recibe el precio del plan a buscar y ejecuta una sentencia SQL (SELECT) que busca coincidencias
en la base de datos. Utiliza la cláusula WHERE para filtrar por precio exacto.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public DataTable ListarPorPrecio(decimal precio)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>precio</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.decimal">decimal</a></dt>
    <dd><p>Precio del plan.</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.data.datatable">DataTable</a></dt>
    <dd><p>DataTable con los resultados de la búsqueda.</p>
</dd>
  </dl>












</article>



      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          Desarrollado por Progoat
        </div>
      </div>
    </footer>
  </body>
</html>
